(function(e){function t(t,r,i){if(r.substr(0,5)!=="touch")return e(t).unbind(r,i);var s,o;for(o=0;o<n._binds.length;o++)n._binds[o].elem===t&&n._binds[o].type===r&&n._binds[o].func===i&&(document.addEventListener?t.removeEventListener(r,n._binds[o].fnc,!1):t.detachEvent("on"+r,n._binds[o].fnc),n._binds.splice(o--,1))}function n(t,r,i,s){if(r.substr(0,5)!=="touch")return e(t).bind(r,s,i);var o,u;if(n[r])return n[r].bind(t,r,i,s);o=function(e){e||(e=window.event),e.stopPropagation||(e.stopPropagation=function(){this.cancelBubble=!0}),e.data=s,i.call(t,e)},document.addEventListener?t.addEventListener(r,o,!1):t.attachEvent("on"+r,o),n._binds.push({elem:t,type:r,func:i,fnc:o})}function r(e,t){var r={move:{x:0,y:0},offset:{x:0,y:0},position:{x:0,y:0},start:{x:0,y:0},affects:document.documentElement,stopPropagation:!1,preventDefault:!0,touch:!0};c(r,t),r.element=e,n(e,h,s,r),r.touch&&n(e,v,a,r)}function i(e){t(e,h,h)}function s(e){e.data.position.x=e.pageX,e.data.position.y=e.pageY,e.data.start.x=e.pageX,e.data.start.y=e.pageY,e.data.event=e;if(e.data.onstart&&e.data.onstart.call(e.data.element,e.data))return;e.preventDefault&&e.data.preventDefault&&e.preventDefault(),e.stopPropagation&&e.data.stopPropagation&&e.stopPropagation(),n(e.data.affects,p,o,e.data),n(e.data.affects,d,u,e.data)}function o(e){e.preventDefault&&e.data.preventDefault&&e.preventDefault(),e.stopPropagation&&e.data.preventDefault&&e.stopPropagation(),e.data.move.x=e.pageX-e.data.position.x,e.data.move.y=e.pageY-e.data.position.y,e.data.position.x=e.pageX,e.data.position.y=e.pageY,e.data.offset.x=e.pageX-e.data.start.x,e.data.offset.y=e.pageY-e.data.start.y,e.data.event=e,e.data.onmove&&e.data.onmove.call(e.data.element,e.data)}function u(e){e.preventDefault&&e.data.preventDefault&&e.preventDefault(),e.stopPropagation&&e.data.stopPropagation&&e.stopPropagation(),t(e.data.affects,p,o),t(e.data.affects,d,u),e.data.event=e,e.data.onfinish&&e.data.onfinish.call(e.data.element,e.data)}function a(e){e.data.position.x=e.touches[0].pageX,e.data.position.y=e.touches[0].pageY,e.data.start.x=e.touches[0].pageX,e.data.start.y=e.touches[0].pageY,e.data.event=e;if(e.data.onstart&&e.data.onstart.call(e.data.element,e.data))return;e.preventDefault&&e.data.preventDefault&&e.preventDefault(),e.stopPropagation&&e.data.stopPropagation&&e.stopPropagation(),n(e.data.affects,m,f,e.data),n(e.data.affects,g,l,e.data)}function f(e){e.preventDefault&&e.data.preventDefault&&e.preventDefault(),e.stopPropagation&&e.data.stopPropagation&&e.stopPropagation(),e.data.move.x=e.touches[0].pageX-e.data.position.x,e.data.move.y=e.touches[0].pageY-e.data.position.y,e.data.position.x=e.touches[0].pageX,e.data.position.y=e.touches[0].pageY,e.data.offset.x=e.touches[0].pageX-e.data.start.x,e.data.offset.y=e.touches[0].pageY-e.data.start.y,e.data.event=e,e.data.onmove&&e.data.onmove.call(e.data.elem,e.data)}function l(e){e.preventDefault&&e.data.preventDefault&&e.preventDefault(),e.stopPropagation&&e.data.stopPropagation&&e.stopPropagation(),t(e.data.affects,m,f),t(e.data.affects,g,l),e.data.event=e,e.data.onfinish&&e.data.onfinish.call(e.data.element,e.data)}var c=e.extend,h="mousedown",p="mousemove",d="mouseup",v="touchstart",m="touchmove",g="touchend",y="touchcancel";n._binds=[],e.fn.grab=function(e,t){return this.each(function(){return r(this,e,t)})},e.fn.ungrab=function(e){return this.each(function(){return i(this,e)})}})(jQuery);